<?xml version='1.1' encoding='UTF-8'?>
<flow-definition plugin="workflow-job@2.40">
  <actions/>
  <description>Unity Demo Build Job</description>
  <keepDependencies>false</keepDependencies>
  <properties/>
  <definition class="org.jenkinsci.plugins.workflow.cps.CpsFlowDefinition" plugin="workflow-cps@2.92">
    <script>
pipeline {
    agent any
    
    stages {
        stage('Test Environment') {
            steps {
                echo 'Testing build environment...'
                sh 'echo "Current user: $(whoami)"'
                sh 'echo "Current directory: $(pwd)"'
                sh 'echo "Available disk space:"'
                sh 'df -h'
                sh 'echo "System info:"'
                sh 'uname -a'
            }
        }
        
        stage('Test Unity (if available)') {
            steps {
                script {
                    sh '''
                        echo "Looking for Unity installation..."
                        find /opt -name "Unity" -type f 2>/dev/null || echo "Unity not found in /opt"
                        which unity || echo "Unity not in PATH"
                        
                        # Test placeholder Unity if exists
                        if [ -f /opt/unity/Editor/Unity ]; then
                            echo "Found Unity at /opt/unity/Editor/Unity"
                            /opt/unity/Editor/Unity -version || echo "Unity version check failed"
                        else
                            echo "Unity not installed - this is expected for basic infrastructure test"
                        fi
                    '''
                }
            }
        }
    }
    
    post {
        always {
            echo 'Build completed!'
        }
        success {
            echo 'Build succeeded!'
        }
        failure {
            echo 'Build failed!'
        }
    }
}
    </script>
    <sandbox>true</sandbox>
  </definition>
  <triggers/>
  <disabled>false</disabled>
</flow-definition>
